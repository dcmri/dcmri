
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>An exploration of water exchange effects &#8212; dcmri 0.6.17 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=cd8af66b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=0d21fabb"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-64ZSJ8Z1MX"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-64ZSJ8Z1MX');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-64ZSJ8Z1MX');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/tutorials/plot_wex';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dealing with inflow effects" href="plot_minipig.html" />
    <link rel="prev" title="The role of Arterial Input Functions" href="plot_aif.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/tristan-logo.jpg" class="logo__image only-light" alt="dcmri 0.6.17 documentation - Home"/>
    <img src="../../_static/tristan-logo.jpg" class="logo__image only-dark pst-js-only" alt="dcmri 0.6.17 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../releases/index.html">
    Releases
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../about/index.html">
    About
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dcmri/dcmri" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../releases/index.html">
    Releases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dcmri/dcmri" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../kidney/index.html">Kidney applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../liver/index.html">Liver function: drug effects</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_aif.html">The role of Arterial Input Functions</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">An exploration of water exchange effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_minipig.html">Dealing with inflow effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_convolution.html">A comparison of convolution functions</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">An exploration of water exchange effects</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-tutorials-plot-wex-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="an-exploration-of-water-exchange-effects">
<span id="sphx-glr-examples-tutorials-plot-wex-py"></span><h1>An exploration of water exchange effects<a class="headerlink" href="#an-exploration-of-water-exchange-effects" title="Link to this heading">#</a></h1>
<p>This tutorial will explore the effect of water exchange in a standard
two-compartmental tissue using the models in <a class="reference internal" href="../../api/dcmri.Tissue.html#dcmri.Tissue" title="dcmri.Tissue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.Tissue</span></code></a>.</p>
<p>The three tissue compartments involved are the blood, interstitium and tissue
cells. The water exchange effects refer to the transport of water across the
barriers between them: <strong>transendothelial</strong> water exchange between blood and
interstitium, and <strong>transcytolemmal</strong> water exchange between interstitium and
tissue cells. The water exchange in the blood compartment between plasma and
red blood cells is assumed to be in the fast exchange limit.</p>
<p>Water exchange across either of these two barriers can be in the
fast-exchange limit (F), restricted (R), or there may be no water exchange at
all (N). Since there are two barriers involved this leads to 3x3=9 possible
water exchange regimes. <a class="reference internal" href="../../api/dcmri.Tissue.html#dcmri.Tissue" title="dcmri.Tissue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.Tissue</span></code></a> denotes these 9 regimes by a
combination of the letters F, R and N: the frst letter refers to the water
exchange across the endothelium, and the second to the water exchange across
the cell wall. For instance, ‘FR’ means fast water exchange (F) across the
endothelium, and restricted water exchange (R) across the cell wall.</p>
<p>For regimes with restricted water exchange, the rate of exchange is quantified
by the permeability-surface area (PS) of water, a quantity in units
of mL/sec/cm3. <a class="reference internal" href="../../api/dcmri.Tissue.html#dcmri.Tissue" title="dcmri.Tissue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.Tissue</span></code></a> uses the notation <code class="docutils literal notranslate"><span class="pre">PSe</span></code> for the
transendothelial water PS and <code class="docutils literal notranslate"><span class="pre">PSc</span></code> for the transcytolemmal PS.</p>
<section id="simulation-setup">
<h2>Simulation setup<a class="headerlink" href="#simulation-setup" title="Link to this heading">#</a></h2>
<p>We set up the simulation by importing the necessary packages and defining
the constants that will be fixed throughout.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dcmri</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dc</span>

<span class="c1"># Generate a synthetic AIF with default settings</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">_</span></a> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">fake_aif</span><span class="p">(</span><span class="n">tacq</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># Save AIF and its properties in a dictionary</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;t&#39;</span><span class="p">:</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span>
    <span class="s1">&#39;aif&#39;</span><span class="p">:</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">,</span>
    <span class="s1">&#39;r1&#39;</span><span class="p">:</span> <span class="n">dc</span><span class="o">.</span><span class="n">relaxivity</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;blood&#39;</span><span class="p">,</span> <span class="s1">&#39;gadodiamide&#39;</span><span class="p">),</span>
    <span class="s1">&#39;R10a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">dc</span><span class="o">.</span><span class="n">T1</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="s1">&#39;blood&#39;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="the-role-of-water-exchange">
<h2>The role of water exchange<a class="headerlink" href="#the-role-of-water-exchange" title="Link to this heading">#</a></h2>
<p>To show how water exchange is relevant in DC-MRI analysis, it is insightful
to first consider the extreme ends of the water exchange spectrum in some
more detail: fast water exchange (F) and no water exchange (N).</p>
<p>Let’s first generate a tissue without water exchange across either barrier.
We will use the more general model of restricted water exchange ‘RR’ and set
the permeabilities to zero, as this then also plots the signals in individual
compartments:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue_nn</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span> <span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="n">PSe</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">PSc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue_nn</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wex_001.png" srcset="../../_images/sphx_glr_plot_wex_001.png" alt="MRI signals, Concentration in indicator compartments, Magnetization in water compartments, Concentration in water compartments" class = "sphx-glr-single-img"/><p>In this model the indicator and water occupy the same compartments, so the
concentrations on the right are the same. The magnetization (bottom left)
follows the profile of the indicator concentrations exactly: since
magnetization cannot
exchange, it cannot equilibrate and remains directly proportional to the
concentration in the compartment. Notably, the magnetization in the tissue
cells remains constant as no indicator can enter this
compartment to modify it, and no magnetization can be transferred.</p>
<p>Now lets consider the opposite scenario of fast water exchange across both
barriers (<em>Note</em>: we could use the FF model here, but for the purposes of
this illustration it is more instructive to use RR with very high values
for the water permeabilities):</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue_ff</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span><span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="n">PSe</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">PSc</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue_ff</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wex_002.png" srcset="../../_images/sphx_glr_plot_wex_002.png" alt="MRI signals, Concentration in indicator compartments, Magnetization in water compartments, Concentration in water compartments" class = "sphx-glr-single-img"/><p>The indicator concentration in the tissue compartments is not affected by
the level of water exchange (top and bottom right), but the magnetization
in all 3 compartments is now effectively the same (bottom left). Even the
tissue cells,
which receive no indicator at all, show the same signal changes over time
as the interstitium and blood compartments. This is because, with very high
levels of water exchange, the magnetization between all 3 compartments mixes
so rapidly that any differences are levelled out instantly. The tissue is
well-mixed for water (and therefore water magnetization), although it is not
well-mixed for indicator.</p>
<p>Now let’s consider the cases where one of the barriers is highly permeable
for water, and the other is impermeable. First let’s look at the case of
high transendothelial water exchange and no transcytolemmal water exchange:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue_fn</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span><span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="n">PSe</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">PSc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue_fn</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wex_003.png" srcset="../../_images/sphx_glr_plot_wex_003.png" alt="MRI signals, Concentration in indicator compartments, Magnetization in water compartments, Concentration in water compartments" class = "sphx-glr-single-img"/><p>As expected, blood and interstitium have the same magnetization throughout
and the magnetization of tissue cells is not altered at all. The opposite
case is similar:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue_nf</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span><span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="n">PSe</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">PSc</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue_nf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wex_004.png" srcset="../../_images/sphx_glr_plot_wex_004.png" alt="MRI signals, Concentration in indicator compartments, Magnetization in water compartments, Concentration in water compartments" class = "sphx-glr-single-img"/><p>In this case the tissue cells recieve the same magnetization as the
interstitium.</p>
</section>
<section id="water-exchange-effect-on-the-mr-signal">
<h2>Water exchange effect on the MR signal<a class="headerlink" href="#water-exchange-effect-on-the-mr-signal" title="Link to this heading">#</a></h2>
<p>From a measurement perspective, the important question is to what extent
water exchange across either barrier affects the measured signal, shown in
the top left corner of the plots above.</p>
<p>To illustrate the signal differences in more detail, we plot signals in
mixed exchange regimes against the extremes of fast and no exchange. For
reference we also include a tissue with intermediate water exchange:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build a tissue in an intermediate water exchange regime</span>
<span class="n">tissue_rr</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span><span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="n">PSe</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">PSc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>

<span class="c1"># Generate signals in all regimes</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_ff</span></a> <span class="o">=</span> <span class="n">tissue_ff</span><span class="o">.</span><span class="n">signal</span><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_nn</span></a> <span class="o">=</span> <span class="n">tissue_nn</span><span class="o">.</span><span class="n">signal</span><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_fn</span></a> <span class="o">=</span> <span class="n">tissue_fn</span><span class="o">.</span><span class="n">signal</span><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_nf</span></a> <span class="o">=</span> <span class="n">tissue_nf</span><span class="o">.</span><span class="n">signal</span><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_rr</span></a> <span class="o">=</span> <span class="n">tissue_rr</span><span class="o">.</span><span class="n">signal</span><span class="p">()</span>

<span class="c1"># Plot signals against extremes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;No transendothelial exchange </span><span class="se">\n</span>
<span class="s2">                Fast transcytolemmal exchange&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Fast transendothelial exchange </span><span class="se">\n</span>
<span class="s2">                No transcytolemmal exchange&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Restricted transendothelial exchange </span><span class="se">\n</span>
<span class="s2">                Restricted transcytolemmal exchange&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_nf</span></a><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mixed exchange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_fn</span></a><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mixed exchange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_rr</span></a><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Restricted exchange&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_ff</span></a><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fast exchange&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_nn</span></a><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No exchange&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (sec)&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Signal (a.u.)&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wex_005.png" srcset="../../_images/sphx_glr_plot_wex_005.png" alt="No transendothelial exchange                    Fast transcytolemmal exchange, Fast transendothelial exchange                    No transcytolemmal exchange, Restricted transendothelial exchange                    Restricted transcytolemmal exchange" class = "sphx-glr-single-img"/><p>These figures show clearly that water exchange levels have a measureable
effect on signals, and at all times lie between the extremes of no water
exchange (blue) and fast water exchange (green).</p>
<p>However, while the effect of water exchange is detectable, it is
comparatively small considering the difference between the blue and green
curves represent the extremes. By contrast, changing the exchange rate of
the indicator between its extremes of no- and infinite indicator exchange
has a more significant impact on the signal:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue_2cx</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span><span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue_nx</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span><span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="n">PS</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue_fx</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span><span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="n">PS</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>

<span class="c1"># Plot signals</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Fast vs no transendothelial indicator exchange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <span class="n">tissue_fx</span><span class="o">.</span><span class="n">signal</span><span class="p">(),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fast indicator exchange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <span class="n">tissue_nx</span><span class="o">.</span><span class="n">signal</span><span class="p">(),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No indicator exchange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <span class="n">tissue_2cx</span><span class="o">.</span><span class="n">signal</span><span class="p">(),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Intermediate indicator exchange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (sec)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Signal (a.u.)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wex_006.png" srcset="../../_images/sphx_glr_plot_wex_006.png" alt="Fast vs no transendothelial indicator exchange" class = "sphx-glr-single-img"/></section>
<section id="water-exchange-bias">
<h2>Water exchange bias<a class="headerlink" href="#water-exchange-bias" title="Link to this heading">#</a></h2>
<p>As shown above, water exchange is to some extent a second order effect
compared to indicator exchange. Nevertheless, making inaccurate assumptions
regarding the level of water exchange can lead to large biases in the other
measured parameters.</p>
<p>One way to explore the scale of this water exchange bias is by training a
tissue that has no water exchange (NN) using data generated by a tissue in
fast water exchange:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train a NN tissue on the fast-exchange signal and plot results</span>
<span class="n">tissue_nn</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue_nn</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_ff</span></a><span class="p">)</span>
<span class="n">tissue_nn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_ff</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wex_007.png" srcset="../../_images/sphx_glr_plot_wex_007.png" alt="MRI signals, Concentration in indicator compartments, Magnetization in water compartments, Concentration in water compartments" class = "sphx-glr-single-img"/><p>The plot shows that the no-exchange tissue predicts the data with high
accuracy. However, the reconstructed magnetization is incorrect for fast
exchange tissue, and the reconstructed parameters are severely biased:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a> <span class="o">=</span> <span class="n">tissue_ff</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="s1">&#39;vp&#39;</span><span class="p">,</span><span class="s1">&#39;vi&#39;</span><span class="p">,</span><span class="s1">&#39;Ktrans&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a> <span class="o">=</span> <span class="n">tissue_nn</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="s1">&#39;vp&#39;</span><span class="p">,</span><span class="s1">&#39;vi&#39;</span><span class="p">,</span><span class="s1">&#39;Ktrans&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vp error:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vi error:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ktrans error:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>vp error: 40.5 %
vi error: 16.9 %
Ktrans error: 0.9 %
</pre></div>
</div>
</section>
<section id="removing-water-exchange-bias">
<h2>Removing water exchange bias<a class="headerlink" href="#removing-water-exchange-bias" title="Link to this heading">#</a></h2>
<p>Water exchange forms a dangerous source of measurement error because it
cannot be detected by comparing the fit to the data. In ideal circumstances,
it can be removed by generalizing the model to allow for any level of water
exchange. Let’s try this and look at the results again:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train an RR tissue and plot again</span>
<span class="n">tissue</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span><span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_ff</span></a><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">tissue</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">signal_ff</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wex_008.png" srcset="../../_images/sphx_glr_plot_wex_008.png" alt="MRI signals, Concentration in indicator compartments, Magnetization in water compartments, Concentration in water compartments" class = "sphx-glr-single-img"/><p>Plotting the results now show a practically perfect fit to the data, and the
magnetization is close to the fast exchange limit. Also the measurements of
the kinetic parameters are more accurate:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a> <span class="o">=</span> <span class="n">tissue</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="s1">&#39;vp&#39;</span><span class="p">,</span><span class="s1">&#39;vi&#39;</span><span class="p">,</span><span class="s1">&#39;Ktrans&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vp error:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vi error:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/-</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ktrans error:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">truth</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>vp error: 1.0 %
vi error: -0.8 %
Ktrans error: 0.7 %
</pre></div>
</div>
<p>As a bonus the water-exchange sensitive model also estimates the water
permeability. While a numerical fit will not produce the accurate result of
infinite water PS, this nevertheless produces values that correspond to
extremely high levels of water exchange:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a> <span class="o">=</span> <span class="n">tissue</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="s1">&#39;PSe&#39;</span><span class="p">,</span> <span class="s1">&#39;PSc&#39;</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PSe:&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;mL/sec/cm3&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PSc:&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;mL/sec/cm3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>PSe: 115.0 mL/sec/cm3
PSc: 126.0 mL/sec/cm3
</pre></div>
</div>
</section>
<section id="handling-water-exchange">
<h2>Handling water exchange<a class="headerlink" href="#handling-water-exchange" title="Link to this heading">#</a></h2>
<p>The above example suggests one strategy of removing water exchange bias,
i.e. include water exchange rates as free parameters and get the added
benefit of a water exchange measurement. However this may not always be the
right approach. The data in this tutorial are noise-free, and therefore even
very subtle structure can be exploited to estimate parameters. In noisy data
this may not be the case, and one may well be forced to fix parameters that
have a relatively small effect on the data in order to improve the precision
in others.</p>
<p>This raises the question where any of the regimes of fast and zero water
exchange offers a good approximation to real tissues. For this exercise we
will assume values on the upper end of literature data. We plot the
resulting signal against the extremes of fast and no exchange:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate tissue</span>
<span class="n">tissue</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span> <span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="n">PSe</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">PSc</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue_nn</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>
<span class="n">tissue_ff</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="s1">&#39;2CX&#39;</span><span class="p">,</span> <span class="s1">&#39;FF&#39;</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aif</span></a><span class="p">)</span>

<span class="c1"># Plot signals</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Restricted water exchange against extremes&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <span class="n">tissue_ff</span><span class="o">.</span><span class="n">signal</span><span class="p">(),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fast water exchange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <span class="n">tissue_nn</span><span class="o">.</span><span class="n">signal</span><span class="p">(),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;No water exchange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">,</span> <span class="n">tissue</span><span class="o">.</span><span class="n">signal</span><span class="p">(),</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Restricted water exchange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (sec)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Signal (a.u.)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wex_009.png" srcset="../../_images/sphx_glr_plot_wex_009.png" alt="Restricted water exchange against extremes" class = "sphx-glr-single-img"/><p>With these settings, the restricated water exchange signal is approximately
intermediate between fast and no water exchange. Hence neither approximation
appears particulare more accurate than the alternative.</p>
<p>However, the impact
of water exchange also depends on the imaging sequence, such as the choice
of flip angle. Hence these effects should be taken into account when
optimizing the scan protocol. Water exchange sensitivity should be maximized
for studies that aim to measure it, and minimized for studies where it is a
confounder.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 4.257 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-tutorials-plot-wex-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ef1ca4fe91d6e5ef237e90271df6f79f/plot_wex.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_wex.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7c76e327b43d2c20e02b3fd413b65ba4/plot_wex.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_wex.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b0c7ec1a81b770b926183b8d32e3fe16/plot_wex.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_wex.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_aif.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The role of Arterial Input Functions</p>
      </div>
    </a>
    <a class="right-next"
       href="plot_minipig.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dealing with inflow effects</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-setup">Simulation setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-role-of-water-exchange">The role of water exchange</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#water-exchange-effect-on-the-mr-signal">Water exchange effect on the MR signal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#water-exchange-bias">Water exchange bias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-water-exchange-bias">Removing water exchange bias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-water-exchange">Handling water exchange</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/examples/tutorials/plot_wex.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2025, dcmri contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>