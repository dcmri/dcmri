
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Getting started &#8212; dcmri 0.6.17 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=cd8af66b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=0d21fabb"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-64ZSJ8Z1MX"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-64ZSJ8Z1MX');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-64ZSJ8Z1MX');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/getting_started';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to use dcmri" href="usage.html" />
    <link rel="prev" title="User guide" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/tristan-logo.jpg" class="logo__image only-light" alt="dcmri 0.6.17 documentation - Home"/>
    <img src="../_static/tristan-logo.jpg" class="logo__image only-dark pst-js-only" alt="dcmri 0.6.17 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../releases/index.html">
    Releases
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../about/index.html">
    About
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dcmri/dcmri" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../releases/index.html">
    Releases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dcmri/dcmri" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">How to use dcmri</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics/index.html">Basic concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="tissues/index.html">Tissue types</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Getting started</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Link to this heading">#</a></h1>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">dcmri</span></code> can be installed using pip:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install dcmri</span>
</pre></div>
</div>
</section>
<section id="basic-usage">
<h2>Basic usage<a class="headerlink" href="#basic-usage" title="Link to this heading">#</a></h2>
<p>The most common application of DCMRI involves measurement of the endothelial
permeability using a steady-state MRI sequence
and a <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/10508281/">Tofts model</a>. In this
section we illustrate the basic usage of <code class="docutils literal notranslate"><span class="pre">dcmri</span></code> by applying this model to
synthetic data.</p>
<p>We start by import the package and generating synthetic region-of-interest
(ROI) data using <a class="reference internal" href="../api/dcmri.fake_tissue.html#dcmri.fake_tissue" title="dcmri.fake_tissue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.fake_tissue</span></code></a>.
We want these to look realistic, so we are adding noise with a
contrast-to-noise ratio (CNR) of 50:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">dcmri</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dc</span>

<span class="n">time</span><span class="p">,</span> <span class="n">aif</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">fake_tissue</span><span class="p">(</span><span class="n">CNR</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Here <em>time</em> is an array of time points, <em>aif</em> is a signal-time curve measured
in a feeding artery at those times, and <em>roi</em> is a signal-time curve measured
in a region of interest.</p>
<p>Next we find a suitable tissue type from the
<a class="reference internal" href="../reference/e2e.html#end-to-end-models"><span class="std std-ref">tissue bank</span></a> and initialize it. For most common
applications, this will be <a class="reference internal" href="../api/dcmri.Tissue.html#dcmri.Tissue" title="dcmri.Tissue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.Tissue</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="n">aif</span><span class="o">=</span><span class="n">aif</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point this is still a generic tissue with default parameter values.
The next step is to train the tissue using the ROI data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">roi</span><span class="p">)</span>
</pre></div>
</div>
<p>And that’s it. We can now display the measured tissue parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue</span><span class="o">.</span><span class="n">print_params</span><span class="p">(</span><span class="n">round_to</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">--------------------------------</span>
<span class="go">Free parameters with their stdev</span>
<span class="go">--------------------------------</span>

<span class="go">Blood volume (vb): 0.018 (0.002) mL/cm3</span>
<span class="go">Interstitial volume (vi): 0.174 (0.004) mL/cm3</span>
<span class="go">Permeability-surface area product (PS): 0.002 (0.0) mL/sec/cm3</span>

<span class="go">----------------------------</span>
<span class="go">Fixed and derived parameters</span>
<span class="go">----------------------------</span>

<span class="go">Tissue Hematocrit (H): 0.45</span>
<span class="go">Plasma volume (vp): 0.01 mL/cm3</span>
<span class="go">Interstitial mean transit time (Ti): 74.614 sec</span>
<span class="go">B1-corrected Flip Angle (FAcorr): 15 deg</span>
</pre></div>
</div>
<p>The standard deviations of the free parameters are orders of magnitude
smaller than the value itself, which offers confidence that the tissue
properties are well determined by the data.</p>
<p>We should also verify that the trained tissue does indeed predict the data
correctly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">roi</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tissue.png"><img alt="../_images/tissue.png" src="../_images/tissue.png" style="width: 600px;" />
</a>
<p>The signal plot on the left shows that the model correctly predicts the
measured data, except for the noise. The plot on the right shows that
the reconstructed concentrations in blood and tissue have the expected
profiles and that values are in an expected range for a standard contrast
agent injection (0-5mM in blood).</p>
</section>
<section id="customizing-the-tissue-model">
<h2>Customizing the tissue model<a class="headerlink" href="#customizing-the-tissue-model" title="Link to this heading">#</a></h2>
<p>Since the extended Tofts model is the most widely used approach, it is set as
default in <a class="reference internal" href="../api/dcmri.Tissue.html#dcmri.Tissue" title="dcmri.Tissue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.Tissue</span></code></a> and does not need to be specified explicitly.
Similarly other configurations such as initial values, parameter ranges and
which parameters to fix in the analysis - are set to reasonable defaults.</p>
<p>Analysing the data with other configurations is not much more difficult. Let’s
do the analysis again, but this time allowing for restricted water-exchange
across the tissue cell walls. We can do this by setting the water exchange
model to ‘FR’, meaning fast (F) water exchange across the endothelium, and
restricted (R) water exchange across the tissue cell walls:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="n">aif</span><span class="o">=</span><span class="n">aif</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">water_exchange</span><span class="o">=</span><span class="s1">&#39;FR&#39;</span><span class="p">)</span>
<span class="n">tissue</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">roi</span><span class="p">)</span><span class="o">.</span><span class="n">print_params</span><span class="p">(</span><span class="n">round_to</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">--------------------------------</span>
<span class="go">Free parameters with their stdev</span>
<span class="go">--------------------------------</span>

<span class="go">Transcytolemmal water PS (PSc): 533.268 (19598.606) mL/sec/cm3</span>
<span class="go">Blood volume (vb): 0.018 (0.002) mL/cm3</span>
<span class="go">Interstitial volume (vi): 0.174 (0.007) mL/cm3</span>
<span class="go">Permeability-surface area product (PS): 0.002 (0.0) mL/sec/cm3</span>

<span class="go">----------------------------</span>
<span class="go">Fixed and derived parameters</span>
<span class="go">----------------------------</span>

<span class="go">Tissue Hematocrit (H): 0.45</span>
<span class="go">Plasma volume (vp): 0.01 mL/cm3</span>
<span class="go">Interstitial mean transit time (Ti): 74.605 sec</span>
<span class="go">Intracellular water mean transit time (Twc): 0.002 sec</span>
<span class="go">B1-corrected Flip Angle (FAcorr): 15 deg</span>
</pre></div>
</div>
<p>We now get an additional value for the water exchange exchange across the
cell wall - which is very high in this case (and imprecise) because the
synthetic data are generated for a tissue with infinite water exchange.</p>
<p>Any other options can be set in the same way. As an example, we run this same
model again, but this time we provide a different initial value for the blood
volume, and we treat the B1-correction factor as a free parameter with
bounds [0,2] (by default this is fixed to 1):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Tissue</span><span class="p">(</span><span class="n">aif</span><span class="o">=</span><span class="n">aif</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">water_exchange</span><span class="o">=</span><span class="s1">&#39;FR&#39;</span><span class="p">,</span> <span class="n">vb</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">tissue</span><span class="o">.</span><span class="n">set_free</span><span class="p">(</span><span class="n">B1corr</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Train the tissue again and print the parameters. We illustrate here also how
methods in dcmri tissue models can be chained:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tissue</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">roi</span><span class="p">)</span><span class="o">.</span><span class="n">print_params</span><span class="p">(</span><span class="n">round_to</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">--------------------------------</span>
<span class="go">Free parameters with their stdev</span>
<span class="go">--------------------------------</span>

<span class="go">Transcytolemmal water PS (PSc): 264.663 (16140.959) mL/sec/cm3</span>
<span class="go">Blood volume (vb): 0.017 (0.003) mL/cm3</span>
<span class="go">Interstitial volume (vi): 0.169 (0.022) mL/cm3</span>
<span class="go">Permeability-surface area product (PS): 0.002 (0.0) mL/sec/cm3</span>
<span class="go">Tissue B1-correction factor (B1corr): 0.98 (0.027)</span>

<span class="go">----------------------------</span>
<span class="go">Fixed and derived parameters</span>
<span class="go">----------------------------</span>

<span class="go">Tissue Hematocrit (H): 0.45</span>
<span class="go">Plasma volume (vp): 0.009 mL/cm3</span>
<span class="go">Interstitial mean transit time (Ti): 74.373 sec</span>
<span class="go">Intracellular water mean transit time (Twc): 0.003 sec</span>
<span class="go">B1-corrected Flip Angle (FAcorr): 14.701 deg</span>
</pre></div>
</div>
<p>Since the synthetic data are generated with an exact flip angle, the B1
correction is close to 1 - as expected.</p>
</section>
<section id="pixel-based-analysis">
<h2>Pixel-based analysis<a class="headerlink" href="#pixel-based-analysis" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">dcmri</span></code> includes dedicated tools for pixel-based analysis. To illustrate these,
we analyse synthetic brain images with an extended Tofts model.</p>
<p>First let’s generate some synthetic brain images. For the purpose of this
illustration we use coarse 128 x 128 images:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">time</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">aif</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">fake_brain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, <em>time</em> and <em>aif</em> are still 1D arrays of time points, but
<em>signal</em> is 3D array (2D + time) with pixel-based synthetic data.</p>
<p>Since the data are now images, we analyse them using <a class="reference internal" href="../api/dcmri.TissueArray.html#dcmri.TissueArray" title="dcmri.TissueArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.TissueArray</span></code></a>
instead of <a class="reference internal" href="../api/dcmri.Tissue.html#dcmri.Tissue" title="dcmri.Tissue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.Tissue</span></code></a>. Since pixel-based computations take more time, we
display a progress bar during computations by setting the verbosity to 1:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">TissueArray</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">aif</span><span class="o">=</span><span class="n">aif</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we train the image model on the data and plot the results:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/pixel.png"><img alt="../_images/pixel.png" src="../_images/pixel.png" style="width: 600px;" />
</a>
<p>As before - by default this runs the extended Tofts model for every pixel.
The model predicts the data well (left) but parameter maps (right) show
unrealistic PS values in the normal brain tissue - a known issue with
this model in the brain. Let’s analyse these data again with a model that is
more suitable for whole-brain analysis (2-compartment uptake model, aka 2CU):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">TissueArray</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">aif</span><span class="o">=</span><span class="n">aif</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kinetics</span><span class="o">=</span><span class="s1">&#39;2CU&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Train the model on the data and plot the maps again:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/pixel_2cu.png"><img alt="../_images/pixel_2cu.png" src="../_images/pixel_2cu.png" style="width: 600px;" />
</a>
<p>The PS values are now zero everywhere, except in the lesions with broken
blood-brain barrier. The maps in the lower row also show that parameter
estimates are unreliable in the ventricles, which are not accessible to the
contrast agent.</p>
<p>Further customization of pixel-based models, such as
setting initial values or modifying parameter ranges, also works in the same
way as for the ROI-based model <a class="reference internal" href="../api/dcmri.Tissue.html#dcmri.Tissue" title="dcmri.Tissue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.Tissue</span></code></a>.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">User guide</p>
      </div>
    </a>
    <a class="right-next"
       href="usage.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">How to use dcmri</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-usage">Basic usage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-the-tissue-model">Customizing the tissue model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pixel-based-analysis">Pixel-based analysis</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user_guide/getting_started.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2025, dcmri contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>