
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Whole body &#8212; dcmri 0.6.17 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=cd8af66b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=0d21fabb"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-64ZSJ8Z1MX"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-64ZSJ8Z1MX');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-64ZSJ8Z1MX');
            </script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/tissues/whole_body';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reference" href="../../reference/index.html" />
    <link rel="prev" title="Kidney" href="kidney.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/tristan-logo.jpg" class="logo__image only-light" alt="dcmri 0.6.17 documentation - Home"/>
    <img src="../../_static/tristan-logo.jpg" class="logo__image only-dark pst-js-only" alt="dcmri 0.6.17 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../releases/index.html">
    Releases
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../about/index.html">
    About
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dcmri/dcmri" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribute/index.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../releases/index.html">
    Releases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dcmri/dcmri" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">How to use dcmri</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/index.html">Basic concepts</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Tissue types</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="exchange.html">Exchange tissues</a></li>
<li class="toctree-l2"><a class="reference internal" href="liver.html">Liver</a></li>
<li class="toctree-l2"><a class="reference internal" href="kidney.html">Kidney</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Whole body</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tissue types</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Whole body</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="whole-body">
<span id="whole-body-tissues"></span><h1>Whole body<a class="headerlink" href="#whole-body" title="Link to this heading">#</a></h1>
<p>Whole body pharmacokinetic models can be built by assembling suitable building
blocks (see section <a class="reference internal" href="../basics/pharmacokinetics.html#basics-pharmacokinetics"><span class="std std-ref">Pharmacokinetics</span></a>) into a closed model
of the circulation. We will illustrate the approach by using a whole-body
model to predict the indicator flux in the aorta
(see <a class="reference internal" href="#whole-body-image"><span class="std std-ref">diagram</span></a> below).</p>
<a class="reference internal image-reference" href="../../_images/whole_body.png" id="whole-body-image"><img alt="../../_images/whole_body.png" id="whole-body-image" src="../../_images/whole_body.png" style="width: 600px;" />
</a>
<p>A model of this type is available through the function <a class="reference internal" href="../../api/dcmri.flux_aorta.html#dcmri.flux_aorta" title="dcmri.flux_aorta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.flux_aorta</span></code></a>,
which has some flexibility to use different models for the organs
in the model. For the purpose of this section we will model the organs as
follows:</p>
<ul class="simple">
<li><p>Heart-lung system: chain (<a class="reference internal" href="../../api/dcmri.flux_chain.html#dcmri.flux_chain" title="dcmri.flux_chain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.flux_chain</span></code></a>).</p></li>
<li><p>Organs: two-compartment exchange model (<a class="reference internal" href="../../api/dcmri.flux_2cxm.html#dcmri.flux_2cxm" title="dcmri.flux_2cxm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.flux_2cxm</span></code></a>).</p></li>
<li><p>Kidneys: one-compartment (<a class="reference internal" href="../../api/dcmri.flux_comp.html#dcmri.flux_comp" title="dcmri.flux_comp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.flux_comp</span></code></a>).</p></li>
<li><p>Liver-gut system: plug-flow compartment (<a class="reference internal" href="../../api/dcmri.flux_pfcomp.html#dcmri.flux_pfcomp" title="dcmri.flux_pfcomp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.flux_pfcomp</span></code></a>).</p></li>
</ul>
<p>Note that, since our aim here is to model the flux in the aorta, we only
need to model the extracellular spaces of kidney and liver as filtered
indicator is not returned to the blood stream.</p>
<p>Assume a known injection <span class="math notranslate nohighlight">\(J_{v,0}(t)\)</span> into the venous system. With a standard bolus
injection this can be approximated by a step function between the start and
end of the injection period (see <a class="reference internal" href="../../api/dcmri.ca_injection.html#dcmri.ca_injection" title="dcmri.ca_injection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.ca_injection</span></code></a>). The first-pass  <span class="math notranslate nohighlight">\(J_{a,1}(t)\)</span>
through the aorta can be computed by propagating the input through the
heart-lung system. Using the <a class="reference internal" href="../basics/pharmacokinetics.html#define-chain"><span class="std std-ref">propagator for a chain</span></a>:</p>
<div class="math notranslate nohighlight">
\[J_{a,1} = h(T_{hl}, D_{hl}) * J_{v,0}\]</div>
<p>The flow through the aorta then splits up into 3 parts: a fraction <span class="math notranslate nohighlight">\(F_l\)</span> enters
the liver, a fraction <span class="math notranslate nohighlight">\(F_k\)</span> enters the kidneys and a fraction <span class="math notranslate nohighlight">\(F_o\)</span> enters the
other organs. These flow fractions must add up to 1, so one is
dependent on the other two:</p>
<div class="math notranslate nohighlight">
\[F_o = 1 - F_k - F_l\]</div>
<p>Each of the three components then pass through their respective organ systems,
to produce the first pass outflux <span class="math notranslate nohighlight">\(J_{k,1}, J_{l,1}, J_{o,1}\)</span> out of
kidney, liver and other organs, respectively. The passage can be computed
by convolution with the appropriate propagator. For the kidnyes this is the
<a class="reference internal" href="../basics/pharmacokinetics.html#define-compartment"><span class="std std-ref">compartment propagator</span></a>:</p>
<div class="math notranslate nohighlight">
\[J_{k,1} = h(T_k) * F_kJ_{a,1}\]</div>
<p>For the liver it is the <a class="reference internal" href="../basics/pharmacokinetics.html#define-pfcomp"><span class="std std-ref">plug-flow compartment</span></a>:</p>
<div class="math notranslate nohighlight">
\[J_{l,1} = h(T_{gl}, D_{gl}) * F_lJ_{a,1}\]</div>
<p>and for the other organs this is the
<a class="reference internal" href="../basics/pharmacokinetics.html#define-2comp"><span class="std std-ref">2-compartment exchange propagator</span></a>:</p>
<div class="math notranslate nohighlight">
\[J_{o,1} = h(T_b, T_e, E_o) * F_oJ_{a,1}\]</div>
<p>These three now join again and add up to produce the first pass in the venous
system. At this stage we also correct for the extraction fraction <span class="math notranslate nohighlight">\(E_{kl}\)</span> by the
combined effect of liver and kidneys:</p>
<div class="math notranslate nohighlight">
\[J_{v,1} = (1-E_{kl})(J_{k,1} + J_{l,1} + J_{o,1})\]</div>
<p>We can now repeat these steps to produce the second pass <span class="math notranslate nohighlight">\(J_{v,2}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}J_{a,2} &amp;= h(T_{hl}, D_{hl}) * J_{v,1}  \\
\\
J_{k,2} &amp;= h(T_k) * F_kJ_{a,2} \\
J_{l,2} &amp;= h(T_{gl}, D_{gl}) * F_lJ_{a,2} \\
J_{o,2} &amp;= h(T_b, T_e, E_o) * F_oJ_{a,2}  \\
\\
J_{v,2} &amp;= (1-E_{kl})(J_{k,2} + J_{l,2} + J_{o,2}) \\\end{split}\]</div>
<p>These steps are iterated to produce the third pass <span class="math notranslate nohighlight">\(J_{a,3}\)</span>, fourth
pass <span class="math notranslate nohighlight">\(J_{a,4}\)</span> and so on. The total flux through the aorta can be
determined by adding up the contributions of each pass:</p>
<div class="math notranslate nohighlight">
\[J_a(t) = \sum_{i=1}^\infty J_{a,i}(t)\]</div>
<p>At each iteration the residual dose in the system reduces because of the
extraction by liver and kidneys, and because dispersion gradually shifts the
bolus beyond the acquisition window.
At some point the total dose becomes too small to have any measureable impact
on the result and we can stop iterating.</p>
<p>In practice we compute the
residual dose <span class="math notranslate nohighlight">\(r_i\)</span> at each iteration (here <span class="math notranslate nohighlight">\(t_\max\)</span> is the total
acquisition time):</p>
<div class="math notranslate nohighlight">
\[r_i = \frac{\int_0^{t_\max} J_{v,i}(t)dt}{\int_0^{t_\max} J_{v,0}(t)dt}\]</div>
<p>And then truncate the sum as soon as the residual dose drops below a user-
defined tolerance.</p>
<p>The analysis shows that this models the aorta flux in terms of 11 independent
parameters: 5 mean transit times <span class="math notranslate nohighlight">\(\{T_{hl}, T_k, T_{gl}, T_p, T_e\}\)</span>, 2
dispersions <span class="math notranslate nohighlight">\(\{D_{hl}, D_{gl}\}\)</span> and 4 independent fractions
<span class="math notranslate nohighlight">\(\{F_k, F_l, E_o, E_{kl}\}\)</span>. The result can be derived in one step by
using the function <a class="reference internal" href="../../api/dcmri.flux_aorta.html#dcmri.flux_aorta" title="dcmri.flux_aorta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcmri.flux_aorta</span></code></a> with the following arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Ja</span> <span class="o">=</span> <span class="n">flux_aorta</span><span class="p">(</span><span class="n">Jv_0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">Ekl</span><span class="p">,</span>
    <span class="n">FFkl</span> <span class="o">=</span> <span class="n">Fk</span> <span class="o">+</span> <span class="n">Fl</span><span class="p">,</span>
    <span class="n">FFk</span> <span class="o">=</span> <span class="n">Fk</span> <span class="o">/</span> <span class="p">(</span><span class="n">Fk</span> <span class="o">+</span> <span class="n">Fl</span><span class="p">),</span>
    <span class="n">heartlung</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chain&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">Thl</span><span class="p">,</span> <span class="n">Dhl</span><span class="p">)],</span>
    <span class="n">organs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2cxm&#39;</span><span class="p">,</span> <span class="p">([</span><span class="n">Tp</span><span class="p">,</span> <span class="n">Te</span><span class="p">],</span> <span class="n">Eo</span><span class="p">)],</span>
    <span class="n">kidneys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;comp&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">Tk</span><span class="p">,)],</span>
    <span class="n">liver</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pfcomp&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">Tgl</span><span class="p">,</span> <span class="n">Dgl</span><span class="p">)],</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Other models can be derived with the same function, for instance a simplified
model where all organs including kidney and liver are modelled by a single
two-compartment exchange model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Ja</span> <span class="o">=</span> <span class="n">flux_aorta</span><span class="p">(</span><span class="n">Jv_0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">Ekl</span><span class="p">,</span>
    <span class="n">heartlung</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chain&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">Thl</span><span class="p">,</span> <span class="n">Dhl</span><span class="p">)],</span>
    <span class="n">organs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2cxm&#39;</span><span class="p">,</span> <span class="p">([</span><span class="n">Tp</span><span class="p">,</span> <span class="n">Te</span><span class="p">],</span> <span class="n">Eo</span><span class="p">)],</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="kidney.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Kidney</p>
      </div>
    </a>
    <a class="right-next"
       href="../../reference/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user_guide/tissues/whole_body.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2025, dcmri contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>